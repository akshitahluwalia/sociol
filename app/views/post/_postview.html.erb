<!--Partial should be provided with "post"-->
<div id="<%= "post_" + post.id.to_s %>" class="post">
  <div class="post_header">
    <span class="author_name"><%= post.user.name %></span>
    <span class="author_username"><%= post.user.username %></span>
  </div>
  <% if post.post_type == Post::SHARED %>
      <div class="post_content_container">
        <div class="sub_post_header">
          <span class="author_name"><%= sub_post.user.name %></span>
          <span class="author_username"><%= sub_post.user.username %></span>
          <% unless FriendMapping.has_mapping current_user.id, sub_post.user.id %>
              <span><%= link_to 'FRIEND', create_friend_request_path(requested: sub_post.user.id), id: 'post_' + post.id.to_s + '_friendlink', remote: true, data: {:from => 'post_' + post.id.to_s  + '_friendlink'} %></span>
          <% end %>
        </div>
        <div class="sub_post_content_container">
        <% if sub_post.post_type == Post::IMAGEPOST || sub_post.post_type == Post::VIDEOPOST %>
            <div class="sub_post_media"></div>
        <% end %>
        <% unless sub_post.content.nil? %>
            <div class="sub_post_content">
              <p><%= sub_post.content %></p>
            </div>
        <% end %>
      </div>
      </div>
  <% else %>
      <div class="post_content_container">
        <% if post.post_type == Post::IMAGEPOST || post.post_type == Post::VIDEOPOST %>
            <div class="post_media"></div>
        <% end %>
        <% unless post.content.nil? %>
            <div class="post_content">
              <p><%= post.content %></p>
            </div>
        <% end %>
      </div>
  <% end %>
  <div class="post_actions">
    <ul>
      <li>
        <%= form_tag reaction_path(post_id = post.id, reaction_type = Reaction::LIKE), remote: true do %>
            <%= submit_tag "LIKE", :id => 'post_' + post.id.to_s + '_' + Reaction::LIKE.to_s, style: if post.liked?(current_user.id) then
                                                                                                       'background-color:red'
                                                                                                     else
                                                                                                       'background-color:blue'
                                                                                                     end %>
        <% end %>
      </li>
      <li>
        <%= form_tag reaction_path(post_id = post.id, reaction_type = Reaction::ANGRY), remote: true do %>
            <%= submit_tag "ANGRY", :id => 'post_' + post.id.to_s + '_' + Reaction::ANGRY.to_s, style: if post.angry?(current_user.id) then
                                                                                                         'background-color:red'
                                                                                                       else
                                                                                                         'background-color:blue'
                                                                                                       end %>
        <% end %>
      </li>
      <li>
        <%= form_tag reaction_path(post_id = post.id, reaction_type = Reaction::SAD), remote: true do %>
            <%= submit_tag "SAD", :id => 'post_' + post.id.to_s + '_' + Reaction::SAD.to_s, style: if post.sad?(current_user.id) then
                                                                                                     'background-color:red'
                                                                                                   else
                                                                                                     'background-color:blue'
                                                                                                   end %>
        <% end %>
      </li>
      <li>
        <%= form_tag reaction_path(post_id = post.id, reaction_type = Reaction::HAPPY), remote: true do %>
            <%= submit_tag "HAPPY", :id => 'post_' + post.id.to_s + '_' + Reaction::HAPPY.to_s, style: if post.happy?(current_user.id) then
                                                                                                         'background-color:red'
                                                                                                       else
                                                                                                         'background-color:blue'
                                                                                                       end %>
        <% end %>
      </li>
      <% if post.user.id == current_user.id %>
          <li><%= link_to "DELETE", post_remove_path(id: post.id), method: :delete, remote: true %></li>
      <% end %>
      <li>Comment</li>
      <li><%= link_to "SHARE", post_share_path(id: post.id), method: :post, remote: true %></li>
    </ul>
  </div>

  <div class="comment_container">
    <div class="comments">

      <%=  post.comments.each do |comment|%>
          <% puts '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>' %>
          <% puts '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>' %>
          <% puts '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>' %>
          <% puts '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>' %>
          <% puts '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>' %>
          <% puts comment %>
        <%= render 'comment/commentview' , comment:comment %>
      <% end %>
    </div>
    <div class="new_comment">
      <%= form_tag url: add_comment_path,remote:true do %>
          <%= label_tag :content%>
          <%= text_field_tag :content%>
          <%= hidden_field_tag :post_id ,value: post.id %>
          <%= submit_tag 'Comment' %>
        <%=  %>
      <% end %>
    </div>
  </div>
</div>